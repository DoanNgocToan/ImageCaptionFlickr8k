2025-12-31 04:00:20.317603: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-31 04:00:31.133134: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
======================================================================
BASELINE: EFFICIENTNET-B2 + SIMPLE LSTM
======================================================================
Device: cuda
Model: EfficientNet-B2
Input Size: 260�260
Feature Map: 9�9�1408
Num Regions: 81
Feature Dim: 1408
----------------------------------------------------------------------
Batch Size: 32
Epochs: 50
Learning Rate: 1e-04
----------------------------------------------------------------------
Embed Size: 512
Hidden Size: 512
----------------------------------------------------------------------
Attention: DISABLED
Scheduled Sampling: DISABLED
======================================================================
Loaded features for 8091 images (3520.6 MB)

Loading captions...
Loaded captions for 8091 images
Cleaning captions...
Building vocabulary (min_freq=1)...
Vocab size: 8369
Max caption length: 34
Rare words filtered: 0 (0.0% of tokens)
Train images: 6472, Test images: 1619
Train batches: 1012, Val batches: 253
Total params: 15,268,529, Trainable: 15,268,529
C:\Users\LAPTOP\anaconda3\envs\fer\Lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

======================================================================
STARTING TRAINING
======================================================================


Epoch 1/50 [Train]: 100%|##########| 1012/1012 [03:14<00:00,  5.20it/s, loss=5.3700]
Epoch 1/50 [Val]: 100%|##########| 253/253 [00:13<00:00, 19.25it/s, loss=4.6234]

Epoch 1/50
Train Loss: 5.8881 | Val Loss: 5.2348
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 5.2348


Epoch 2/50 [Train]: 100%|##########| 1012/1012 [02:37<00:00,  6.42it/s, loss=5.5039]
Epoch 2/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.44it/s, loss=4.2165]

Epoch 2/50
Train Loss: 5.1567 | Val Loss: 4.8874
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.8874


Epoch 3/50 [Train]: 100%|##########| 1012/1012 [02:32<00:00,  6.64it/s, loss=5.0045]
Epoch 3/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.08it/s, loss=4.0265]

Epoch 3/50
Train Loss: 4.8699 | Val Loss: 4.6833
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.6833


Epoch 4/50 [Train]: 100%|##########| 1012/1012 [02:32<00:00,  6.63it/s, loss=4.9119]
Epoch 4/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.49it/s, loss=3.9430]

Epoch 4/50
Train Loss: 4.6877 | Val Loss: 4.5570
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.5570


Epoch 5/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.67it/s, loss=4.0443]
Epoch 5/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.34it/s, loss=3.8463]

Epoch 5/50
Train Loss: 4.5448 | Val Loss: 4.4667
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.4667


Epoch 6/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=4.8765]
Epoch 6/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.82it/s, loss=3.7947]

Epoch 6/50
Train Loss: 4.4372 | Val Loss: 4.4077
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.4077


Epoch 7/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.67it/s, loss=4.2007]
Epoch 7/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.50it/s, loss=3.7614]

Epoch 7/50
Train Loss: 4.3446 | Val Loss: 4.3717
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.3717


Epoch 8/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=4.7023]
Epoch 8/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.60it/s, loss=3.7165]

Epoch 8/50
Train Loss: 4.2648 | Val Loss: 4.3381
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.3381


Epoch 9/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=4.4861]
Epoch 9/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.32it/s, loss=3.6812]

Epoch 9/50
Train Loss: 4.1966 | Val Loss: 4.3132
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.3132


Epoch 10/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=4.1033]
Epoch 10/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.26it/s, loss=3.6542]

Epoch 10/50
Train Loss: 4.1313 | Val Loss: 4.2937
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.2937


Epoch 11/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.67it/s, loss=3.9145]
Epoch 11/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.57it/s, loss=3.6367]

Epoch 11/50
Train Loss: 4.0717 | Val Loss: 4.2762
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.2762


Epoch 12/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=3.4829]
Epoch 12/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.03it/s, loss=3.6425]

Epoch 12/50
Train Loss: 4.0179 | Val Loss: 4.2705
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.2705


Epoch 13/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.68it/s, loss=3.7946]
Epoch 13/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.32it/s, loss=3.6010]

Epoch 13/50
Train Loss: 3.9674 | Val Loss: 4.2602
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.2602


Epoch 14/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.68it/s, loss=4.2624]
Epoch 14/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.84it/s, loss=3.6063]

Epoch 14/50
Train Loss: 3.9225 | Val Loss: 4.2516
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
New best model! Val Loss: 4.2516


Epoch 15/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.69it/s, loss=4.0599]
Epoch 15/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.88it/s, loss=3.6137]

Epoch 15/50
Train Loss: 3.8764 | Val Loss: 4.2533
LR: 0.000100
No improvement for 1 epoch(s)


Epoch 16/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.70it/s, loss=3.8304]
Epoch 16/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.21it/s, loss=3.5904]

Epoch 16/50
Train Loss: 3.8342 | Val Loss: 4.2626
LR: 0.000100
No improvement for 2 epoch(s)


Epoch 17/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.68it/s, loss=3.8505]
Epoch 17/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.75it/s, loss=3.5822]

Epoch 17/50
Train Loss: 3.7795 | Val Loss: 4.2621
LR: 0.000070
No improvement for 3 epoch(s)


Epoch 18/50 [Train]: 100%|##########| 1012/1012 [02:31<00:00,  6.66it/s, loss=3.1863]
Epoch 18/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.19it/s, loss=3.6036]

Epoch 18/50
Train Loss: 3.7461 | Val Loss: 4.2705
LR: 0.000070
No improvement for 4 epoch(s)


Epoch 19/50 [Train]: 100%|##########| 1012/1012 [02:32<00:00,  6.66it/s, loss=3.1145]
Epoch 19/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.43it/s, loss=3.6066]

Epoch 19/50
Train Loss: 3.7091 | Val Loss: 4.2723
LR: 0.000049
No improvement for 5 epoch(s)
Early stopping after 19 epochs

TRAINING COMPLETED


Training completed!
Best model saved at: .\content\clean_data_flickr8k\baseline_efficientnet_b2_simple_lstm.pth
C:\Users\LAPTOP\Documents\Code\Python\EfficientNet_Full_Flavor_Attention.py:899: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(paths['model'], map_location=Config.DEVICE)
Loaded best model from epoch 14 with val loss 4.2516


Research Evaluation: 100%|##########| 1619/1619 [00:51<00:00, 31.41it/s]

RESEARCH METRICS (BASELINE - NO ATTENTION)
==================================================
BLEU-1 (nltk): 0.4927
BLEU-2 (nltk): 0.3259
BLEU-3 (nltk): 0.2180
BLEU-4 (nltk): 0.1382
BLEU-1 (linear BP): 0.4892
BLEU-2 (linear BP): 0.3235
BLEU-3 (linear BP): 0.2164
BLEU-4 (linear BP): 0.1373
METEOR: 0.2876
Avg Pred Len: 7.9036
Avg Ref Len: 7.9160
Len Ratio: 0.9984
==================================================

============================================================
Image ID: 3517124784_4b4eb62a7a
ACTUAL CAPTIONS:
1. startseq female batter misses yellow ball while another player practices behind her endseq
2. startseq female softball player hit the ball and is running towards first base endseq
3. startseq female wearing baseball uniform swinging bat endseq
4. startseq girl in white and brown uniform swings at softball endseq
5. startseq woman in brown strip is taking swing with baseball bat at yellow ball whilst another woman is waiting on the sideline endseq

PREDICTED (greedy):
two men playing baseball

PREDICTED (beam size=3):
two men playing baseball
============================================================


============================================================
Image ID: 2908466042_bf07cb52c7
ACTUAL CAPTIONS:
1. startseq two blond dogs fight in living room endseq
2. startseq two brown dogs playing around with each other in house endseq
3. startseq two dogs bite each others faces inside of house endseq
4. startseq two dogs biting at each other endseq
5. startseq two dogs play rough with each other indoors endseq

PREDICTED (greedy):
brown dog is laying on the ground with its mouth open

PREDICTED (beam size=3):
brown dog is laying on the ground with stick in its mouth
============================================================


============================================================
Image ID: 613900608_2e49415772
ACTUAL CAPTIONS:
1. startseq dancer in dancing pose on the street audience in the background endseq
2. startseq female performer is barefoot and performing in front of crowd endseq
3. startseq woman in tank top and capri pants costume taking bow in the street endseq
4. startseq woman with beads around her neck is performing dance as part of parade endseq
5. startseq female street entertainer with horns doing curtsey endseq

PREDICTED (greedy):
young girl in pink shirt and black shirt is jumping in front of crowd

PREDICTED (beam size=3):
young girl is jumping in front of crowd
============================================================


Done.
