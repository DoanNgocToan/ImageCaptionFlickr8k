2025-12-31 02:56:51.388967: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-31 02:56:56.421364: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
======================================================================
BASELINE: EFFICIENTNET-B0 + SIMPLE LSTM
======================================================================
Device: cuda
Model: EfficientNet-B0
Input Size: 224�224
Feature Map: 7�7�1280
Num Regions: 49
Feature Dim: 1280
----------------------------------------------------------------------
Batch Size: 32
Epochs: 50
Learning Rate: 1e-04
----------------------------------------------------------------------
Embed Size: 512
Hidden Size: 512
----------------------------------------------------------------------
Attention: DISABLED
Scheduled Sampling: DISABLED
======================================================================
Loaded features for 8091 images (1936.4 MB)

Loading captions...
Loaded captions for 8091 images
Cleaning captions...
Building vocabulary (min_freq=1)...
Vocab size: 8369
Max caption length: 34
Rare words filtered: 0 (0.0% of tokens)
Train images: 6472, Test images: 1619
Train batches: 1012, Val batches: 253
Total params: 14,875,313, Trainable: 14,875,313
C:\Users\LAPTOP\anaconda3\envs\fer\Lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

======================================================================
STARTING TRAINING
======================================================================

Epoch 1/50 [Train]: 100%|##########| 1012/1012 [02:41<00:00,  6.28it/s, loss=5.5482]
Epoch 1/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.53it/s, loss=5.5007]

Epoch 1/50
Train Loss: 5.8831 | Val Loss: 5.2713
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 5.2713


Epoch 2/50 [Train]: 100%|##########| 1012/1012 [02:41<00:00,  6.29it/s, loss=4.9422]
Epoch 2/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.61it/s, loss=5.1381]

Epoch 2/50
Train Loss: 5.1583 | Val Loss: 4.9221
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.9221


Epoch 3/50 [Train]: 100%|##########| 1012/1012 [02:40<00:00,  6.29it/s, loss=4.3216]
Epoch 3/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.02it/s, loss=4.9371]

Epoch 3/50
Train Loss: 4.8746 | Val Loss: 4.7193
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.7193


Epoch 4/50 [Train]: 100%|##########| 1012/1012 [02:41<00:00,  6.28it/s, loss=4.3739]
Epoch 4/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.72it/s, loss=4.8098]

Epoch 4/50
Train Loss: 4.6855 | Val Loss: 4.5904
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.5904


Epoch 5/50 [Train]: 100%|##########| 1012/1012 [02:40<00:00,  6.30it/s, loss=4.8681]
Epoch 5/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 32.46it/s, loss=4.7496]

Epoch 5/50
Train Loss: 4.5493 | Val Loss: 4.5072
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.5072


Epoch 6/50 [Train]: 100%|##########| 1012/1012 [02:40<00:00,  6.31it/s, loss=4.7278]
Epoch 6/50 [Val]: 100%|##########| 253/253 [00:07<00:00, 33.31it/s, loss=4.6760]

Epoch 6/50
Train Loss: 4.4389 | Val Loss: 4.4517
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.4517


Epoch 7/50 [Train]: 100%|##########| 1012/1012 [02:44<00:00,  6.16it/s, loss=4.0324]
Epoch 7/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 22.32it/s, loss=4.6194]

Epoch 7/50
Train Loss: 4.3471 | Val Loss: 4.4091
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.4091


Epoch 8/50 [Train]: 100%|##########| 1012/1012 [03:10<00:00,  5.31it/s, loss=4.2315]
Epoch 8/50 [Val]: 100%|##########| 253/253 [00:10<00:00, 23.86it/s, loss=4.6009]

Epoch 8/50
Train Loss: 4.2687 | Val Loss: 4.3769
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3769


Epoch 9/50 [Train]: 100%|##########| 1012/1012 [03:11<00:00,  5.28it/s, loss=4.4960]
Epoch 9/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 22.70it/s, loss=4.5461]

Epoch 9/50
Train Loss: 4.1996 | Val Loss: 4.3543
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3543


Epoch 10/50 [Train]: 100%|##########| 1012/1012 [03:12<00:00,  5.27it/s, loss=3.9501]
Epoch 10/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 22.77it/s, loss=4.5236]

Epoch 10/50
Train Loss: 4.1350 | Val Loss: 4.3367
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3367


Epoch 11/50 [Train]: 100%|##########| 1012/1012 [03:11<00:00,  5.29it/s, loss=4.1935]
Epoch 11/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 22.94it/s, loss=4.5220]

Epoch 11/50
Train Loss: 4.0777 | Val Loss: 4.3285
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3285


Epoch 12/50 [Train]: 100%|##########| 1012/1012 [03:13<00:00,  5.23it/s, loss=4.1443]
Epoch 12/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.53it/s, loss=4.4990]

Epoch 12/50
Train Loss: 4.0218 | Val Loss: 4.3101
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3101


Epoch 13/50 [Train]: 100%|##########| 1012/1012 [03:12<00:00,  5.25it/s, loss=3.9993]
Epoch 13/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.88it/s, loss=4.5095]

Epoch 13/50
Train Loss: 3.9727 | Val Loss: 4.3102
LR: 0.000100
No improvement for 1 epoch(s)


Epoch 14/50 [Train]: 100%|##########| 1012/1012 [03:13<00:00,  5.22it/s, loss=3.5131]
Epoch 14/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.35it/s, loss=4.4742]

Epoch 14/50
Train Loss: 3.9211 | Val Loss: 4.3035
LR: 0.000100
Model saved to .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
New best model! Val Loss: 4.3035


Epoch 15/50 [Train]: 100%|##########| 1012/1012 [03:14<00:00,  5.20it/s, loss=3.6199]
Epoch 15/50 [Val]: 100%|##########| 253/253 [00:12<00:00, 20.95it/s, loss=4.5057]

Epoch 15/50
Train Loss: 3.8792 | Val Loss: 4.3083
LR: 0.000100
No improvement for 1 epoch(s)


Epoch 16/50 [Train]: 100%|##########| 1012/1012 [03:13<00:00,  5.23it/s, loss=3.6140]
Epoch 16/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.38it/s, loss=4.4855]

Epoch 16/50
Train Loss: 3.8367 | Val Loss: 4.3060
LR: 0.000100
No improvement for 2 epoch(s)


Epoch 17/50 [Train]: 100%|##########| 1012/1012 [03:12<00:00,  5.26it/s, loss=3.4665]
Epoch 17/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.91it/s, loss=4.5155]

Epoch 17/50
Train Loss: 3.7811 | Val Loss: 4.3071
LR: 0.000070
No improvement for 3 epoch(s)


Epoch 18/50 [Train]: 100%|##########| 1012/1012 [03:14<00:00,  5.22it/s, loss=3.8115]
Epoch 18/50 [Val]: 100%|##########| 253/253 [00:11<00:00, 21.39it/s, loss=4.4830]

Epoch 18/50
Train Loss: 3.7500 | Val Loss: 4.3129
LR: 0.000070
No improvement for 4 epoch(s)


Epoch 19/50 [Train]: 100%|##########| 1012/1012 [03:13<00:00,  5.22it/s, loss=3.8268]
Epoch 19/50 [Val]: 100%|##########| 253/253 [00:12<00:00, 20.99it/s, loss=4.5099]

Epoch 19/50
Train Loss: 3.7100 | Val Loss: 4.3258
LR: 0.000049
No improvement for 5 epoch(s)
Early stopping after 19 epochs

TRAINING COMPLETED


Training completed!
Best model saved at: .\content\clean_data_flickr8k\baseline_efficientnet_b0_simple_lstm.pth
C:\Users\LAPTOP\Documents\Code\Python\EfficientNet_Full_Flavor_Attention.py:899: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(paths['model'], map_location=Config.DEVICE)
Loaded best model from epoch 14 with val loss 4.3035


Research Evaluation: 100%|##########| 1619/1619 [02:05<00:00, 12.90it/s]

RESEARCH METRICS (BASELINE - NO ATTENTION)
==================================================
BLEU-1 (nltk): 0.4915
BLEU-2 (nltk): 0.3312
BLEU-3 (nltk): 0.2209
BLEU-4 (nltk): 0.1378
BLEU-1 (linear BP): 0.4900
BLEU-2 (linear BP): 0.3302
BLEU-3 (linear BP): 0.2202
BLEU-4 (linear BP): 0.1375
METEOR: 0.2855
Avg Pred Len: 7.7480
Avg Ref Len: 7.9870
Len Ratio: 0.9701
==================================================

============================================================
Image ID: 2979914158_5906470b8f
ACTUAL CAPTIONS:
1. startseq girl in bathing suit rides swing endseq
2. startseq young girl wearing black and red swimsuit swinging on swing endseq
3. startseq young girl with brown hair is swinging on swing in swimming suit endseq
4. startseq child on swing in motion endseq
5. startseq the little girl wearing black swimsuit is playing on swing endseq

PREDICTED (greedy):
girl in pink shirt is jumping over the ground

PREDICTED (beam size=3):
little girl in pink shirt is swinging on swing
============================================================


============================================================
Image ID: 2346523971_d3f1e12ce4
ACTUAL CAPTIONS:
1. startseq three girls dancing in front of couple of musicians endseq
2. startseq three girls in hats and dresses dance to music played by boys in the background endseq
3. startseq three girls in western hats dance for band endseq
4. startseq three girls wear straw hats and dance on stage endseq
5. startseq three young girls in hats are dancing endseq

PREDICTED (greedy):
woman in red shirt and white shirt is playing guitar

PREDICTED (beam size=3):
woman in red shirt is playing guitar
============================================================


============================================================
Image ID: 2431120202_b24fe2333a
ACTUAL CAPTIONS:
1. startseq girl crosscountry skis endseq
2. startseq girl on skis in snow endseq
3. startseq little girl wearing purple winter coat and sunglasses skiing in the snow endseq
4. startseq little girl on skis endseq
5. startseq the young girl is crosscountry skiing endseq

PREDICTED (greedy):
little girl in red jacket is riding down the snow

PREDICTED (beam size=3):
little girl in red jacket is skiing down snowy hill
============================================================


Done.
